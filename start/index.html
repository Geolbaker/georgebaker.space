<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Stage 1 - Slider Puzzle</title>
  <style>
    body {
      font-family: sans-serif;
      background: #f9f9f9;
      margin: 2rem;
    }

    .layout-wrapper {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 50px;
    }

    .content-row {
      display: flex;
      flex-direction: row;
      align-items: center;
    }

    .container {
      position: relative;
      width: 400px;
      height: 400px;
      overflow: hidden;
      border: 2px solid #ccc;
    }

    .image {
      width: 100%;
      height: 100%;
      mix-blend-mode: exclusion;
      pointer-events: none;
    }

    .wrapOuter, .wrapMiddle, .wrapInner {
      position: absolute;
      width: 100%;
      height: 100%;
      transition: none;
      mix-blend-mode: exclusion;
      z-index: 1;
    }

    .slider {
      appearance: none;
      background: #ccc;
      border-radius: 4px;
      outline: none;
      width: 400px;
    }

    .slider.horizontal {
      width: 400px;
      height: 8px;
      background: #ccc;
      border-radius: 4px;
    }

    .slider.vertical {
      width: 400px;
      height: 8px;
      transform: rotate(270deg);
      transform-origin: center;
      position: absolute;
      top: 200px;
      left: -140px;
    }

    .slider-wrapper {
      height: 400px; 
      width: 125px;
      position: relative;
    }

    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 14px;
      height: 14px;
      background: #444;
      border-radius: 50%;
      cursor: pointer;
      margin-top: -3px;
    }

    .slider::-moz-range-thumb {
      width: 14px;
      height: 14px;
      background: #444;
      border-radius: 50%;
      cursor: pointer;
    }

    .slider::-webkit-slider-runnable-track {
      background: #ccc;
      border-radius: 4px;
      height: 100%;
    }

    .container::before,
    .container::after {
      content: '';
      position: absolute;
      width: 800px;
      height: 800px;
      top: -200px;
      left: -200px;
      z-index: 0;
      pointer-events: none;
      transition: opacity 2s ease;
    }

    .container::before {
      background: repeating-conic-gradient(#A4D8DD 0deg 15deg, #91D1DB 15deg 30deg);
      animation: spin 15s linear infinite;
      opacity: 1;
    }

    .container::after {
      background: repeating-conic-gradient(#f2e27d 0deg 15deg, #f8d95e 15deg 30deg);
      opacity: 0;
    }

    .container.solved::before {
      animation: none;
      opacity: 0;
    }

    .container.solved::after {
      opacity: 1;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .overlay-link {
      position: absolute;
      inset: 0;
      z-index: 10;
      display: none;
      text-decoration: none;
    }

    .container.solved .overlay-link {
      display: block;
    }

    #hidden-link-wrapper a {
      position: absolute;
      inset: 0;
      z-index: 10;
      display: none;
      text-decoration: none;
    }
  </style>
</head>
<body>

<div class="layout-wrapper">

  <input type="range" id="slider1" min="-100" max="100" value="0" class="slider horizontal top" />

  <div class="content-row">

    <div class="slider-wrapper">
      <input type="range" id="slider3" min="-100" max="100" value="0" class="slider vertical" />
    </div>

    <div class="container">
      <div id="hidden-link-wrapper"></div>

      <div id="wrap1-outer" class="wrapOuter">
        <div id="wrap1-mid" class="wrapMiddle">
          <div id="wrap1-inner" class="wrapInner">
            <img src="https://georgebaker.space/start/start-1.png" class="image" />
          </div>
        </div>
      </div>

      <div id="wrap2-outer" class="wrapOuter">
        <div id="wrap2-mid" class="wrapMiddle">
          <div id="wrap2-inner" class="wrapInner">
            <img src="https://georgebaker.space/start/start-2.png" class="image" />
          </div>
        </div>
      </div>

      <div id="wrap3-outer" class="wrapOuter">
        <div id="wrap3-mid" class="wrapMiddle">
          <div id="wrap3-inner" class="wrapInner">
            <img src="https://georgebaker.space/start/start-3.png" class="image" />
          </div>
        </div>
      </div>

      <div id="wrap4-outer" class="wrapOuter">
        <div id="wrap4-mid" class="wrapMiddle">
          <div id="wrap4-inner" class="wrapInner">
            <img src="https://georgebaker.space/start/start-4.png" class="image" />
          </div>
        </div>
      </div>
    </div>

    <div class="slider-wrapper">
      <input type="range" id="slider4" min="-100" max="100" value="0" class="slider vertical" />
    </div>
  </div>

  <input type="range" id="slider2" min="-100" max="100" value="0" class="slider horizontal bottom" />
</div>

<script>
  const sliders=[document.getElementById("slider1"),document.getElementById("slider2"),document.getElementById("slider3"),document.getElementById("slider4")],layerKeys=["wrap1","wrap2","wrap3","wrap4"];let playerHasInteracted=!1,snapped=!1;const wrapperTransforms={wrap1:[-20,76],wrap2:[-72,28],wrap3:[-12,29],wrap4:[-33,15]};function getChunk(e){let r={0:["u","!","f","@","g"],1:[115,98,102],2:()=>atob("Y2hh")};return 0===e?r[0].filter((e,r)=>r%2==0).map((e,r)=>String.fromCharCode(e.charCodeAt(0)-[3,1,4][r])).join(""):1===e?r[1].map(e=>String.fromCharCode(18^e)).join(""):2===e?r[2]():""}function assembleHiddenPath(){let e=getChunk(0),r=getChunk(1),a=getChunk(2);return"/"+[2,1,0].sort().map(t=>[e,r,a][t]).join("")}function revealHiddenLink(){let e=document.createElement("a");e.href=assembleHiddenPath(),e.setAttribute("aria-label","Continue"),e.classList.add("overlay-link"),e.style.display="block";let r=document.getElementById("hidden-link-wrapper");r.appendChild(e)}function applyOffset(e,r,a="x"){let[t,n]=wrapperTransforms[e];setTransform(`${e}-outer`,t,a),setTransform(`${e}-mid`,n,a),setTransform(`${e}-inner`,r,a)}function setTransform(e,r,a="x"){let t=document.getElementById(e);t.style.transform="x"===a?`translate(${r}px, 0)`:`translate(0, ${r}px)`}function snapToAligned(e,r="x"){["outer","mid","inner"].forEach(r=>{let a=document.getElementById(`${e}-${r}`);a.style.transition="transform 1.5s ease-in-out",a.style.transform="translate(0px, 0px)"})}function updateTransforms(){if(snapped)return;let e={wrap1:+sliders[0].value,wrap2:+sliders[1].value,wrap3:-1*sliders[2].value,wrap4:-1*sliders[3].value};if(applyOffset("wrap1",e.wrap1,"x"),applyOffset("wrap2",e.wrap2,"x"),applyOffset("wrap3",e.wrap3,"y"),applyOffset("wrap4",e.wrap4,"y"),!playerHasInteracted)return;let r=layerKeys.every((r,a)=>{let[t,n]=wrapperTransforms[r],s=e[r];return 2>=Math.abs(t+n+s)});r&&(snapped=!0,sliders.forEach(e=>e.disabled=!0),snapToAligned("wrap1","x"),snapToAligned("wrap2","x"),snapToAligned("wrap3","y"),snapToAligned("wrap4","y"),document.querySelector(".container").classList.add("solved"),revealHiddenLink(),console.log("âœ… Puzzle snapped into correct alignment."))}sliders.forEach(e=>e.addEventListener("input",()=>{playerHasInteracted=!0,updateTransforms()})),updateTransforms();
</script>
</body>
</html>
